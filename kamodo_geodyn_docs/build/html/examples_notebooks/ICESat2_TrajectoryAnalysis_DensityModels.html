

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>A Trajectory Analysis using the ICESat2 Satellite &mdash; Kamodo-GEODYN Documentation tbd documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="A Trajectory Analysis using the ICESat2 Satellite" href="ICESat2_TrajectoryAnalysis_MSISModels.html" />
    <link rel="prev" title="MSIS Version Evaluation- Multiple Arcs" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Kamodo-GEODYN Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../a_about_proj/about.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../a_about_proj/about.html#kamodo">Kamodo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../a_about_proj/about.html#geodyn">GEODYN</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started on AWS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../b_getting_started/accessing_AWS.html">Accessing AWS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../b_getting_started/accessing_AWS.html#access-the-aws-server">Access the AWS Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../b_getting_started/accessing_AWS.html#activating-a-jupyter-environment-set-port-forwarding">Activating a Jupyter environment (set port forwarding):</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../b_getting_started/navigating_AWS.html">Navigating AWS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../b_getting_started/navigating_AWS.html#directory-structure-of-the-geodyn-project">Directory Structure of the GEODYN Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../b_getting_started/navigating_AWS.html#directories-and-files-of-importance">Directories and Files of Importance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../b_getting_started/navigating_AWS.html#geodyn-output-readers">GEODYN output readers:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../b_getting_started/navigating_AWS.html#msis-evaluation-notebooks">MSIS Evaluation Notebooks:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../b_getting_started/navigating_AWS.html#geodyn-source-code">GEODYN Source Code:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../b_getting_started/navigating_AWS.html#geodyn-starlette-runs">GEODYN Starlette Runs:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../b_getting_started/navigating_AWS.html#starlette-run-directory">Starlette Run Directory:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../b_getting_started/navigating_AWS.html#starlette-run-output">Starlette Run Output:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../b_getting_started/installs_and_techtips.html">Installations and Technical Tips</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../b_getting_started/installs_and_techtips.html#installing-miniconda3">Installing miniconda3 :</a></li>
<li class="toctree-l2"><a class="reference internal" href="../b_getting_started/installs_and_techtips.html#installing-kamodo">Installing Kamodo:</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Understanding GEODYN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../c_understanding_geodyn/understanding_geodyn.html">GEODYN Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/understanding_geodyn.html#geodyn-internal-programs">GEODYN Internal Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/understanding_geodyn.html#important-files-inputs-and-outputs">Important Files: Inputs and Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/understanding_geodyn.html#drag-assessment-output-products">Drag Assessment: Output Products</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html">Understanding the Setup file/Card deck</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#setup-deck-structure"><strong>Setup Deck Structure:</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#example-icesat2-with-pce-data-trajectory-analysis">Example: ICESat2 with PCE Data– Trajectory Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#initial-setup-deck"><strong>Initial setup deck:</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#modified-cards"><strong>Modified Cards:</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#orbfil">ORBFIL:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#obsvu">OBSVU:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#prntvu">PRNTVU:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#atmden">ATMDEN:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../c_understanding_geodyn/the_setup_deck.html#cardname">CARDNAME:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Modifying GEODYN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../d_modifying_geodyn/modify_subroutines_rst.html">Modifying GEODYN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../d_modifying_geodyn/modify_subroutines_rst.html#list-of-major-modifications">List of Major Modifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../d_modifying_geodyn/modify_subroutines_rst.html#modification-details">Modification Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../d_modifying_geodyn/modify_subroutines_rst.html#print-model-density">1) Print Model Density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../d_modifying_geodyn/modify_subroutines_rst.html#iieout-density-model-identifier">2) iieout density model identifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../d_modifying_geodyn/modify_subroutines_rst.html#and-4-include-msise00-and-msise2-into-the-geodyn-source-code">3) and 4) Include MSISe00 and MSISe2 into the GEODYN Source code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../d_modifying_geodyn/modify_subroutines_rst.html#modying-the-msis-drhodz-calculation">5) Modying the MSIS DRHODZ Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../d_modifying_geodyn/modify_subroutines_rst.html#remove-the-atgrav-printing-to-iis-iieout">6) Remove the ATGRAV printing to IIS/IIEOUT</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../d_modifying_geodyn/pygeodyn_drho_dz_eval.html">Investigating the modification of the DRHODZ variable in the MSIS.f90 subroutine.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../d_modifying_geodyn/pygeodyn_drho_dz_eval.html#Want-to-show:">Want to show:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../d_modifying_geodyn/pygeodyn_drho_dz_eval.html#Import-base-parameters">Import base parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../d_modifying_geodyn/pygeodyn_drho_dz_eval.html#Load-different-versions">Load different versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../d_modifying_geodyn/pygeodyn_drho_dz_eval.html#Read-Data-into-Objects">Read Data into Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../d_modifying_geodyn/pygeodyn_drho_dz_eval.html#Plot-Results">Plot Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Assessing Density Model Performance</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../e_density_model_evaluation/density_assessments.html">Starlette Satellite (SLR Data)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../e_density_model_evaluation/density_assessments.html#msis-version-comparisons">MSIS Version Comparisons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html">MSIS Version Evaluation- Multiple Arcs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Details:">Details:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Background:">Background:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Relative-model-performance:">Relative model performance:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Load-the-simulations-over-all-arcs">Load the simulations over all arcs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Set-the-plot-configurations">Set the plot configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Details-and-Background:">Details and Background:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Cd-Analysis">Cd Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Adjusted-Cd-Plot-(timeseries)">Adjusted Cd Plot (timeseries)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Scale-Density-with-the-Cd-scale-factor:">Scale Density with the Cd scale factor:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Density-output-Analysis">Density output Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Density-timeseries-plot">Density timeseries plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Orbit-averaged-Density-Plot">Orbit averaged Density Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Composite-Plots,-density,-cd,-activity-indicies">Composite Plots, density, cd, activity indicies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#id1">Details:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#id2">Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Observed-Residuals-timeseries-plot">Observed Residuals timeseries plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Residual-Measurement-Summary-plots-(RMS-of-fit)">Residual Measurement Summary plots (RMS of fit)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html#Residuals-–-station-summary">Residuals – station summary</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../e_density_model_evaluation/density_assessments.html#icesat2-satellite-pce-data">ICESat2 Satellite (PCE Data)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">A Trajectory Analysis using the ICESat2 Satellite</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Step-0:-Pre-processing-the-PCE-data-into-a-G2B-file">Step 0: Pre-processing the PCE data into a G2B file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PygeodynPreprocessing">PygeodynPreprocessing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Step-1:-Run-GEODYN-using-Pygeodyn-with-the-ICESat2-configuration">Step 1: Run GEODYN using Pygeodyn with the ICESat2 configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Step-1.1:-Run-with-MSIS2">Step 1.1: Run with MSIS2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-1.2:-Run-with-DTM87-for-comparison">Step 1.2: Run with DTM87 for comparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-1.2:-Run-with-Jaachia-71-Model-for-comparison">Step 1.2: Run with Jaachia 71 Model for comparison</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Read-GEODYN-Output-using-PygeodynRead-functionality">Read GEODYN Output using PygeodynRead functionality</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Get-MSIS2-Data">Get MSIS2 Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Get-DTM87-Data">Get DTM87 Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Get-Jaachia-71-Data">Get Jaachia 71 Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Analyze-output">Analyze output</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#1.-Residuals-of-the-POD-across-many-arcs">1. Residuals of the POD across many arcs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Looking-at-the-arc-overlap-time:">Looking at the arc overlap time:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#PCE-Data-and-the-Orbit-File:">PCE Data and the Orbit File:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Residual-Component-Trajectory:">Residual Component Trajectory:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html">A Trajectory Analysis using the ICESat2 Satellite</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#Read-GEODYN-Output-using-PygeodynRead-functionality">Read GEODYN Output using PygeodynRead functionality</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#Get-MSIS2-Data">Get MSIS2 Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#Get-MSIS00-Data">Get MSIS00 Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#Get-MSIS86-Data">Get MSIS86 Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#Analyze-output">Analyze output</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#1.-Residuals-of-the-POD-across-many-arcs">1. Residuals of the POD across many arcs</a></li>
<li class="toctree-l4"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#Looking-at-the-arc-overlap-time:">Looking at the arc overlap time:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#PCE-Data-and-the-Orbit-File:">PCE Data and the Orbit File:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_MSISModels.html#Residual-Component-Trajectory:">Residual Component Trajectory:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html">Trajectory Analysis: 15 Days</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Run-GEODYN-over-desired-arcs-for-all-dens:">Run GEODYN over desired arcs for all dens:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Get-Data">Get Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Write-DataObject-to-a-pickle">Write DataObject to a pickle</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Load-Pickles">Load Pickles</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Read-Memory-usage:">Read Memory usage:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Plots">Plots</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Plot:-Residual-Summaries">Plot: Residual Summaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Plot:-XYZ-Component-Residuals">Plot: XYZ Component Residuals</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Plot:-Adjusted-Cd">Plot: Adjusted Cd</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Plot:-XYZ+NTW+RSW">Plot: XYZ+NTW+RSW</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Plot:-NTW-Residuals-w/-CD-Scaling-factor">Plot: NTW Residuals w/ CD Scaling factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#In-track-arc-overlap">In-track arc overlap</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#Plot:-Model-Density-+-Scaled-with-Cd-factor">Plot: Model Density + Scaled with Cd factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="ICESat2_TrajectoryAnalysis_ccmc_pres.html#ADDITIONAL-PLOTS:">ADDITIONAL PLOTS:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Using Pygeodyn</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../f_pygeodyn/pygeodyn_info.html">Introduction to <code class="docutils literal notranslate"><span class="pre">PYGEODYN</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="../f_pygeodyn/pygeodyn_info.html#pygeody-capabilities">PYGEODY Capabilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_demo.html">Using Pygeodyn: ICESat2 Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started_demo.html#Some-notes-for-Preparing/Making-a-run:">Some notes for Preparing/Making a run:</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_demo.html#Run-GEODYN">Run GEODYN</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_demo.html#Reading-GEODYN-output">Reading GEODYN output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting_started_demo.html#Look-at-output-object">Look at output object</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Descriptive Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../c_understanding_geodyn/Demo__Run_Geodyn.html">Demo: Running GEODYN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/Demo__Run_Geodyn.html#Locations-of-requisite-files-and-scripts">Locations of requisite files and scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__Run_Geodyn.html#GEODYN-IIS-and-IIE-executables:">GEODYN IIS and IIE executables:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__Run_Geodyn.html#Setup-Files-(Unit-5)-to-read-into-GEODYN:">Setup Files (Unit 5) to read into GEODYN:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__Run_Geodyn.html#Script-that-runs-GEODYN:">Script that runs GEODYN:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__Run_Geodyn.html#GEODYN-Output:">GEODYN Output:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/Demo__Run_Geodyn.html#Running-GEODYN:">Running GEODYN:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__Run_Geodyn.html#Inside-the-GEODYN-script:">Inside the GEODYN script:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html">Demo: The Setup File</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#Location">Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#Card-Options">Card Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#DRAG">DRAG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#CONDRG">CONDRG</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#OBSVU">OBSVU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#RESIDU">RESIDU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#ORBFIL">ORBFIL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#ORBTVU">ORBTVU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#ATMDEN">ATMDEN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_setup_file.html#ACCEL9">ACCEL9</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_output_explained.html">Demo: Reading Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_output_explained.html#Adjusted-Parameters">Adjusted Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_output_explained.html#Trajectory-Data">Trajectory Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_output_explained.html#Density-Data">Density Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_understanding_geodyn/Demo__geodyn_output_explained.html#Residual-Data">Residual Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing_rvgs_to_ascii.html">Reading and Processing .RVG binary files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="preprocessing_rvgs_to_ascii.html#The-goal-here:">The goal here:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="preprocessing_rvgs_to_ascii.html#Methodology-for-pre-processing-the-binary-files:">Methodology for pre-processing the binary files:</a></li>
<li class="toctree-l3"><a class="reference internal" href="preprocessing_rvgs_to_ascii.html#Info-on-the-binary-files:">Info on the binary files:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="preprocessing_rvgs_to_ascii.html#1)-Dump-the-data-into-usable-format-with-scipy.io.FortranFile">1) Dump the data into usable format with <code class="docutils literal notranslate"><span class="pre">scipy.io.FortranFile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessing_rvgs_to_ascii.html#1.a-Look-at-the-data-for-a-few-files-to-see-the-discontinuities.">1.a Look at the data for a few files to see the discontinuities.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing_rvgs_to_ascii.html#Construct-G2B-files">Construct G2B files</a></li>
<li class="toctree-l1"><a class="reference internal" href="read_orbfil_binary.html">Reading the Binary Orbit File</a></li>
</ul>
<p class="caption"><span class="caption-text">Documents and Write-ups</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../g_documents_writeups/include_docs.html">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../g_documents_writeups/include_docs.html#adding-msis-versions-to-geodyn">Adding MSIS versions to GEODYN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../g_documents_writeups/include_docs.html#amending-the-drhodz-calculation">Amending the DRHODZ calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../g_documents_writeups/include_docs.html#drag-document">Drag Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="../g_documents_writeups/include_docs.html#kamodo-geodyn-interface">KAMODO-GEODYN Interface</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">To do</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">To do list:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html#notes">Notes:</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Kamodo-GEODYN Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../e_density_model_evaluation/density_assessments.html">Starlette Satellite (SLR Data)</a> &raquo;</li>
        
      <li>A Trajectory Analysis using the ICESat2 Satellite</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples_notebooks/ICESat2_TrajectoryAnalysis_DensityModels.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="A-Trajectory-Analysis-using-the-ICESat2-Satellite">
<h1>A Trajectory Analysis using the ICESat2 Satellite<a class="headerlink" href="#A-Trajectory-Analysis-using-the-ICESat2-Satellite" title="Permalink to this headline">¶</a></h1>
<p><strong>Overview of the steps involved:</strong></p>
<ol class="arabic simple">
<li><p>Get very high-fidelity orbit trajectory information of the primary satellite:</p>
<ul class="simple">
<li><p>This can be done using a POD-reduced dynamics run in which all empirical accelerations and other parameters are used to compensate for any mismodelled forces.</p></li>
<li><p>This has already been done for our purposes.</p></li>
</ul>
</li>
<li><p>Do a run of GEODYN in which the orbit trajectory IS the tracking datatype (PCE).</p>
<ul class="simple">
<li><p>Use this run type to do all density model assessments</p></li>
<li><p>The residuals will be the difference from the truth.</p></li>
</ul>
</li>
<li><p>Methods for assessing the density models (using trajectory run type):</p></li>
</ol>
<ul class="simple">
<li><p>General fit (residuals and RMS)</p></li>
<li><p>Arc overlap</p>
<ul>
<li><p>If any arcs overlap, look at how well different density models provide consistency between overlapping arcs</p></li>
</ul>
</li>
<li><p>Test of prediction - Do a fit from t1 to t2 and then predict to some t3. If the density model is better, the difference between predicted orbit (t2 to t3) and the precise trajectory (PCE data) will contain how well the model is doing.</p></li>
</ul>
<div class="section" id="Step-0:-Pre-processing-the-PCE-data-into-a-G2B-file">
<h2>Step 0: Pre-processing the PCE data into a G2B file<a class="headerlink" href="#Step-0:-Pre-processing-the-PCE-data-into-a-G2B-file" title="Permalink to this headline">¶</a></h2>
<p>We will construct a <code class="docutils literal notranslate"><span class="pre">G2B_PCE</span></code>file from a set of binary <code class="docutils literal notranslate"><span class="pre">.rvg</span></code> files which contain trajectory output from a reduced-dynamics run of GEODYN. The files will be stitched together to create a the GEODYN-specific, trajectory-based tracking data type (called PCE (Precice-Clock-Error) ) and stored in a G2B file.</p>
<p>Each <code class="docutils literal notranslate"><span class="pre">.rvg</span></code> file contains a <strong>30-hour arc of ICESat2 trajectory data</strong>. These datasets are the output from a very precise run of GEODYN in which the orbit has been determined very well (<em>to a few centimeters accuracy</em>) using a <strong>reduced dynamics technique</strong> (<em>empirical accelerations and other parameters are adjusted to account for any mismodelled forces)</em>.</p>
<p>The process that takes place in <code class="docutils literal notranslate"><span class="pre">pygeodyn</span></code> is as follows: 1. dump the data from each arc into a usable format 2. chop of the 3 hour padding on the ends to eliminate discontinuities from end effects 3. stitch together all the files 4. smooth over any existing discontinuities between arc gaps or maneuvers. 5. All data is placed in a single <code class="docutils literal notranslate"><span class="pre">TRAJ.txt</span></code> file which is then fed into a Fortran script (<code class="docutils literal notranslate"><span class="pre">pce_converer.f</span></code>) which converts the data into a <code class="docutils literal notranslate"><span class="pre">G2B</span></code> file to be ingested on <code class="docutils literal notranslate"><span class="pre">fort.40</span></code> of
the GEODYN run.</p>
<div class="section" id="PygeodynPreprocessing">
<h3>PygeodynPreprocessing<a class="headerlink" href="#PygeodynPreprocessing" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">copy</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;/data/geodyn_proj/pygeodyn/pygeodyn_develop/util_preprocessing/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PYGEODYN_Preprocess</span> <span class="kn">import</span> <span class="n">PygeodynPreprocessing</span>

<span class="n">path_to_prep_directory</span> <span class="o">=</span> <span class="s1">&#39;/data/data_geodyn/inputs/icesat2/pre_processing&#39;</span>
<span class="n">path_to_binaryrvg</span>     <span class="o">=</span> <span class="s1">&#39;/data/data_geodyn/inputs/icesat2/pre_processing/traj_files_rvg&#39;</span>

<span class="n">arc1_files</span> <span class="o">=</span> <span class="p">[</span>
              <span class="s1">&#39;orbit.1807001.2018.331&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.334&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.335&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.336&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.337&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.338&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.341&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.345&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.348&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.349&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.351&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.352&#39;</span><span class="p">,</span>
              <span class="s1">&#39;orbit.1807001.2018.353&#39;</span><span class="p">,</span>
                <span class="p">]</span>

<span class="c1">##### Uncomment the below call to overwrite the G2B data by re-running the pre-processing code</span>
<span class="n">Obj</span> <span class="o">=</span> <span class="n">PygeodynPreprocessing</span><span class="p">(</span><span class="n">path_to_binaryrvg</span><span class="p">,</span> <span class="n">path_to_prep_directory</span><span class="p">,</span>  <span class="n">arc1_files</span><span class="p">)</span>
<span class="n">Obj</span><span class="o">.</span><span class="n">run_preprocess_PCE</span><span class="p">()</span>


<span class="c1"># break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
      Running through the pre-processing procedure...
      =======================================================
      STEP 1: Convert RVG binary files to pandas DataFrame...
      =======================================================
      Loading and processing 13 files will take approx. 11.81 minutes.
            Not including unzipping/zipping times

      --- File 1 / 13
      ----- Unzipping file... orbit.1807001.2018.331
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.331

      --- File 2 / 13
      ----- Unzipping file... orbit.1807001.2018.334
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.334

      --- File 3 / 13
      ----- Unzipping file... orbit.1807001.2018.335
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.335

      --- File 4 / 13
      ----- Unzipping file... orbit.1807001.2018.336
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.336

      --- File 5 / 13
      ----- Unzipping file... orbit.1807001.2018.337
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.337

      --- File 6 / 13
      ----- Unzipping file... orbit.1807001.2018.338
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.338

      --- File 7 / 13
      ----- Unzipping file... orbit.1807001.2018.341
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.341

      --- File 8 / 13
      ----- Unzipping file... orbit.1807001.2018.345
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.345

      --- File 9 / 13
      ----- Unzipping file... orbit.1807001.2018.348
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.348

      --- File 10 / 13
      ----- Unzipping file... orbit.1807001.2018.349
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.349

      --- File 11 / 13
      ----- Unzipping file... orbit.1807001.2018.351
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.351

      --- File 12 / 13
      ----- Unzipping file... orbit.1807001.2018.352
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.352

      --- File 13 / 13
      ----- Unzipping file... orbit.1807001.2018.353
      ----- The file has ~109434 records. Will take ~54 seconds
      ----- End of file
      Zipping file... orbit.1807001.2018.353


      =======================================================
      STEP 3: Make ASCII.txt file to be read by FORTRAN code.
      =======================================================


      =======================================================
      STEP 4: Call fortran code to construct G2B file.
      =======================================================

pce_fortran.f compiled
pce_fortran.f executed

The G2B file has been saved to:  /data/data_geodyn/inputs/icesat2/g2b/ g2b_pce .gz
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Step-1:-Run-GEODYN-using-Pygeodyn-with-the-ICESat2-configuration">
<h2>Step 1: Run GEODYN using Pygeodyn with the ICESat2 configuration<a class="headerlink" href="#Step-1:-Run-GEODYN-using-Pygeodyn-with-the-ICESat2-configuration" title="Permalink to this headline">¶</a></h2>
<p>As a reminder, PYGEODYN is called with the <code class="docutils literal notranslate"><span class="pre">PYGEODYN</span></code> class, but modifications to the ICESAT2 configuration are largely controlled through the <code class="docutils literal notranslate"><span class="pre">Satellite_ICESat2</span></code> class in the <code class="docutils literal notranslate"><span class="pre">PYGEODYN_Satellites.py</span></code> file. Please refer to this file first for file structure setups and modifications to the Pygeodyn structure.</p>
<div class="section" id="Step-1.1:-Run-with-MSIS2">
<h3>Step 1.1: Run with MSIS2<a class="headerlink" href="#Step-1.1:-Run-with-MSIS2" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### Identify which arcs you want to run:</span>
<span class="n">arcs_files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;2018.313&#39;</span><span class="p">,</span> <span class="c1"># 1</span>
            <span class="s1">&#39;2018.314&#39;</span><span class="p">,</span> <span class="c1"># 2</span>
            <span class="s1">&#39;2018.315&#39;</span><span class="p">,</span> <span class="c1"># 3</span>
            <span class="s1">&#39;2018.316&#39;</span><span class="p">,</span> <span class="c1"># 4</span>
            <span class="s1">&#39;2018.317&#39;</span><span class="p">,</span> <span class="c1"># 5</span>
<span class="c1">#             &#39;2018.318&#39;, # 6</span>
<span class="c1">#             &#39;2018.319&#39;, # 7</span>
<span class="c1">#             &#39;2018.320&#39;, # 8</span>
<span class="c1">#             &#39;2018.321&#39;, # 9</span>
<span class="c1">#             &#39;2018.322&#39;, # 10</span>
             <span class="p">]</span>

<span class="c1">#------ A dictionary containing the run parameters ------</span>
<span class="n">run_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">run_params</span><span class="p">[</span><span class="s1">&#39;arc&#39;</span><span class="p">]</span>              <span class="o">=</span>   <span class="n">arcs_files</span>
<span class="n">run_params</span><span class="p">[</span><span class="s1">&#39;satellite&#39;</span><span class="p">]</span>        <span class="o">=</span>  <span class="s1">&#39;icesat2&#39;</span>
<span class="n">run_params</span><span class="p">[</span><span class="s1">&#39;den_model&#39;</span><span class="p">]</span>        <span class="o">=</span>  <span class="s1">&#39;msis2&#39;</span>
<span class="n">run_params</span><span class="p">[</span><span class="s1">&#39;SpecialRun_name&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="s1">&#39;_TrajAnalysis&#39;</span>
<span class="n">run_params</span><span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">]</span>          <span class="o">=</span>  <span class="kc">False</span>
<span class="n">run_params</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span>           <span class="o">=</span>  <span class="s1">&#39;run&#39;</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/data/geodyn_proj/pygeodyn/pygeodyn_develop/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PYGEODYN</span> <span class="kn">import</span> <span class="n">Pygeodyn</span>


<span class="c1">#### ---------------------------------------------</span>
<span class="c1">####</span>
<span class="c1">#### ----------------- RUN MSIS2.0 ---------------</span>
<span class="c1">####</span>
<span class="c1">#### ---------------------------------------------</span>

<span class="c1">##### Use copy.deepcopy to copy all levels of dictionary and</span>
<span class="c1">###       allow modification of new variable</span>
<span class="n">run_params1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">run_params</span><span class="p">)</span>
<span class="n">run_params1</span><span class="p">[</span><span class="s1">&#39;den_model&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="s1">&#39;msis2&#39;</span>

<span class="c1"># ### Run pyeodyn for the arcs in the above set.</span>
<span class="c1"># Obj_Geodyn = Pygeodyn(run_params1)</span>
<span class="c1"># Obj_Geodyn.RUN_GEODYN()</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Step-1.2:-Run-with-DTM87-for-comparison">
<h3>Step 1.2: Run with DTM87 for comparison<a class="headerlink" href="#Step-1.2:-Run-with-DTM87-for-comparison" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/data/geodyn_proj/pygeodyn/pygeodyn_develop/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PYGEODYN</span> <span class="kn">import</span> <span class="n">Pygeodyn</span>

<span class="c1">#### ---------------------------------------------</span>
<span class="c1">####</span>
<span class="c1">#### ------------------- RUN DTM -----------------</span>
<span class="c1">####</span>
<span class="c1">#### ---------------------------------------------</span>


<span class="c1">##### Use copy.deepcopy to copy all levels of dictionary and</span>
<span class="c1">###       allow modification of new variable</span>
<span class="n">run_params2</span>                      <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">run_params</span><span class="p">)</span>
<span class="n">run_params2</span><span class="p">[</span><span class="s1">&#39;den_model&#39;</span><span class="p">]</span>         <span class="o">=</span>  <span class="s1">&#39;dtm87&#39;</span>

<span class="c1">### Run pyeodyn for the arcs in the above set.</span>
<span class="c1"># Obj_Geodyn = Pygeodyn(run_params2)</span>
<span class="c1"># Obj_Geodyn.RUN_GEODYN()</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Step-1.2:-Run-with-Jaachia-71-Model-for-comparison">
<h3>Step 1.2: Run with Jaachia 71 Model for comparison<a class="headerlink" href="#Step-1.2:-Run-with-Jaachia-71-Model-for-comparison" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/data/geodyn_proj/pygeodyn/pygeodyn_develop/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PYGEODYN</span> <span class="kn">import</span> <span class="n">Pygeodyn</span>


<span class="c1">#### ----------------------------------------------</span>
<span class="c1">####</span>
<span class="c1">#### ----------------- RUN JAACHIA -----------------</span>
<span class="c1">####</span>
<span class="c1">#### ----------------------------------------------</span>

<span class="c1">##### Use copy.deepcopy to copy all levels of dictionary and</span>
<span class="c1">###       allow modification of new variable</span>
<span class="n">run_params3</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">run_params</span><span class="p">)</span>
<span class="n">run_params3</span><span class="p">[</span><span class="s1">&#39;den_model&#39;</span><span class="p">]</span>         <span class="o">=</span>  <span class="s1">&#39;jaachia71&#39;</span>


<span class="c1">##### Run pyeodyn for the arcs in the above set.</span>
<span class="c1"># Obj_Geodyn = Pygeodyn(run_params3)</span>
<span class="c1"># Obj_Geodyn.RUN_GEODYN()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Read-GEODYN-Output-using-PygeodynRead-functionality">
<h2>Read GEODYN Output using PygeodynRead functionality<a class="headerlink" href="#Read-GEODYN-Output-using-PygeodynRead-functionality" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Get-MSIS2-Data">
<h3>Get MSIS2 Data<a class="headerlink" href="#Get-MSIS2-Data" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/data/geodyn_proj/pygeodyn/pygeodyn_develop/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PYGEODYN</span> <span class="kn">import</span> <span class="n">Pygeodyn</span>

<span class="c1">#------ A dictionary containing the run parameters ------</span>
<span class="n">run_params1</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">run_params1</span><span class="p">[</span><span class="s1">&#39;arc&#39;</span><span class="p">]</span>               <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;2018.313&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;2018.314&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;2018.315&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;2018.316&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;2018.317&#39;</span><span class="p">,</span>
                                    <span class="p">]</span>
<span class="n">run_params1</span><span class="p">[</span><span class="s1">&#39;satellite&#39;</span><span class="p">]</span>         <span class="o">=</span>  <span class="s1">&#39;icesat2&#39;</span>
<span class="n">run_params1</span><span class="p">[</span><span class="s1">&#39;den_model&#39;</span><span class="p">]</span>         <span class="o">=</span>  <span class="s1">&#39;msis2&#39;</span>
<span class="n">run_params1</span><span class="p">[</span><span class="s1">&#39;SpecialRun_name&#39;</span><span class="p">]</span>   <span class="o">=</span>  <span class="s1">&#39;_TrajAnalysis&#39;</span>
<span class="n">run_params1</span><span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">]</span>           <span class="o">=</span>  <span class="kc">False</span>
<span class="n">run_params1</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span>            <span class="o">=</span>  <span class="s1">&#39;read&#39;</span>
<span class="n">run_params1</span><span class="p">[</span><span class="s1">&#39;request_data&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AdjustedParams&#39;</span><span class="p">,</span>
                 <span class="c1">#                    &#39;Trajectory_xyz&#39;,</span>
                                    <span class="s1">&#39;Trajectory_orbfil&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Density&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Residuals_obs&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Residuals_summary&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Statistics&#39;</span><span class="p">,</span>
                                   <span class="p">]</span>

<span class="n">Obj_Geodyn1</span> <span class="o">=</span> <span class="n">Pygeodyn</span><span class="p">(</span><span class="n">run_params1</span><span class="p">)</span>
<span class="n">Obj_Geodyn1</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Get-DTM87-Data">
<h3>Get DTM87 Data<a class="headerlink" href="#Get-DTM87-Data" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">from</span> <span class="nn">PYGEODYN</span> <span class="kn">import</span> <span class="n">Pygeodyn</span>
<span class="kn">import</span> <span class="nn">copy</span>


<span class="n">run_params2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">run_params1</span><span class="p">)</span>

<span class="n">run_params2</span><span class="p">[</span><span class="s1">&#39;den_model&#39;</span><span class="p">]</span>         <span class="o">=</span>  <span class="s1">&#39;dtm87&#39;</span>

<span class="n">Obj_Geodyn2</span> <span class="o">=</span> <span class="n">Pygeodyn</span><span class="p">(</span><span class="n">run_params2</span><span class="p">)</span>
<span class="n">Obj_Geodyn2</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Get-Jaachia-71-Data">
<h3>Get Jaachia 71 Data<a class="headerlink" href="#Get-Jaachia-71-Data" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">from</span> <span class="nn">PYGEODYN</span> <span class="kn">import</span> <span class="n">Pygeodyn</span>
<span class="c1"># import copy</span>


<span class="n">run_params3</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">run_params1</span><span class="p">)</span>
<span class="n">run_params3</span><span class="p">[</span><span class="s1">&#39;den_model&#39;</span><span class="p">]</span>         <span class="o">=</span>  <span class="s1">&#39;jaachia71&#39;</span>

<span class="n">Obj_Geodyn3</span> <span class="o">=</span> <span class="n">Pygeodyn</span><span class="p">(</span><span class="n">run_params3</span><span class="p">)</span>
<span class="n">Obj_Geodyn3</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>

</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Analyze-output">
<h2>Analyze output<a class="headerlink" href="#Analyze-output" title="Permalink to this headline">¶</a></h2>
<p>Our analysis has the following output products:</p>
<ol class="arabic simple">
<li><p>Residuals of the POD across many arcs</p></li>
<li><p>RMS of fit of the POD across many arcs</p></li>
<li><p>Adjustment of the drag coefficient (drag acceleration to compensate for inaccuracies in the density model.)</p></li>
<li><p>Check of consistency (in the residuals) across overlapping arc times</p></li>
<li><p>RMS of the overlapping residual difference (this removes the PCE contribution) Using the <code class="docutils literal notranslate"><span class="pre">Orbfil</span></code>:</p></li>
<li><p>From ORBFIL grab the overlapping ephemeris and difference the two models. Compare this against the same of prediction</p>
<ul class="simple">
<li><p>How well does the predicted time period match up with the determined ephemeris (see this in the resids of the two).</p></li>
</ul>
</li>
<li><p>Calculate and plot the radial component of the trajectory</p></li>
</ol>
<!-- Our analysis has the following output products:

**Per Arc:**

1. Residuals
2. RMS of fit of the residuals
3. Adjustment of the Drag Coefficient

**Per Arc Overlaps:**

4. Check of Consistency
5. RMS of the overlap residual difference (this removes the PCE contribution)
6. From ORBFIL grab the overlapping ephemeris and difference the two models. Compare this against the same of prediction

**Trajectory Prediction:**
Use the orbit file to investigate the predicted time period.

6. How well does the predicted time period match up with the determined ephemeris (residuals).




CONVERT TO RADIAL COMPONENT! --><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="kn">import</span> <span class="n">plot</span><span class="p">,</span> <span class="n">iplot</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>


<span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span>
                <span class="s1">&#39;displayModeBar&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;responsive&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="c1">#                 &#39;staticPlot&#39;: True,</span>
                <span class="s1">&#39;displaylogo&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;showTips&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="1.-Residuals-of-the-POD-across-many-arcs">
<h3>1. Residuals of the POD across many arcs<a class="headerlink" href="#1.-Residuals-of-the-POD-across-many-arcs" title="Permalink to this headline">¶</a></h3>
<p>Resids = PCE - POD Trajectory</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">from</span> <span class="nn">PYGEODYNAnalysis_icesat2PCEtrajectory</span> <span class="kn">import</span> <span class="n">plot_residual_meas_summary</span>
<span class="kn">from</span> <span class="nn">PYGEODYNAnalysis_icesat2PCEtrajectory</span> <span class="kn">import</span> <span class="n">rms_summary_table</span>


<span class="n">Obj_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Obj_Geodyn1</span><span class="p">,</span><span class="n">Obj_Geodyn2</span><span class="p">,</span><span class="n">Obj_Geodyn3</span><span class="p">,]</span>
<span class="n">rms_summary_table</span><span class="p">(</span><span class="n">Obj_list</span><span class="p">)</span>



<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">subplot_titles</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;Mean Residuals per Arc&quot;</span><span class="p">,</span> <span class="s1">&#39;RMS of Fit per Arc&#39;</span><span class="p">]),</span>
     <span class="n">vertical_spacing</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_residual_meas_summary</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_residual_meas_summary</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_residual_meas_summary</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>


</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">from</span> <span class="nn">PYGEODYNAnalysis_icesat2PCEtrajectory</span> <span class="kn">import</span> <span class="n">plot_residuals_observed</span>



<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">subplot_titles</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">]),</span>
            <span class="n">vertical_spacing</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                       <span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_residuals_observed</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_residuals_observed</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_residuals_observed</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Observation Residuals (PCE - Observed , T.O.R.)&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">PYGEODYNAnalysis_icesat2PCEtrajectory</span> <span class="kn">import</span> <span class="n">plot_cd_and_percdiff_from_apriori</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
    <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">subplot_titles</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;Timeseries of Cd&quot;</span><span class="p">,</span> <span class="s2">&quot;Percent difference from a priori (Cd=2.2)&quot;</span><span class="p">]),</span>
    <span class="n">vertical_spacing</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_cd_and_percdiff_from_apriori</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span>  <span class="n">Obj_Geodyn2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_cd_and_percdiff_from_apriori</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span>  <span class="n">Obj_Geodyn3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_cd_and_percdiff_from_apriori</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span>  <span class="n">Obj_Geodyn1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">from</span> <span class="nn">PYGEODYNAnalysis_icesat2PCEtrajectory</span> <span class="kn">import</span> <span class="n">plot_ScaleDensity_with_CdScaleFactor__2</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">subplot_titles</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;Model Ouptut Density&quot;</span><span class="p">,</span> <span class="s2">&quot;Model Density * Cd Scaling Factor&quot;</span><span class="p">]),</span>
                <span class="n">shared_yaxes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">vertical_spacing</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">specs</span><span class="o">=</span><span class="p">[</span>
                <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}],</span>
                <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}],</span> <span class="p">])</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_ScaleDensity_with_CdScaleFactor__2</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span>  <span class="n">Obj_Geodyn2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_ScaleDensity_with_CdScaleFactor__2</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span>  <span class="n">Obj_Geodyn3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_ScaleDensity_with_CdScaleFactor__2</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span>  <span class="n">Obj_Geodyn1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># min_y = 1*1e-16</span>
<span class="c1"># max_y = 9*1e-12</span>
<span class="c1"># fig.update_yaxes(range=[min_y, max_y], row=1, col=1)</span>
<span class="c1"># fig.update_yaxes(range=[min_y, max_y], row=2, col=1)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Looking-at-the-arc-overlap-time:">
<h3>Looking at the arc overlap time:<a class="headerlink" href="#Looking-at-the-arc-overlap-time:" title="Permalink to this headline">¶</a></h3>
<p>We want to show the residuals in the overlap time with the PCE data subtracted away.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">####  ARC_OVERLAP_ObsResids_XYZ</span>

<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">from</span> <span class="nn">PYGEODYNAnalysis_icesat2PCEtrajectory</span> <span class="kn">import</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_XYZ</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">subplot_titles</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">]),</span>
            <span class="n">vertical_spacing</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">specs</span><span class="o">=</span><span class="p">[</span> <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">True</span> <span class="p">}],</span>
                    <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">True</span> <span class="p">}],</span>
                    <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">True</span> <span class="p">}],</span> <span class="p">],)</span>

<span class="n">arc1</span> <span class="o">=</span> <span class="s1">&#39;2018.314&#39;</span>  <span class="c1"># &#39;2018.314&#39;</span>
<span class="n">arc2</span> <span class="o">=</span> <span class="s1">&#39;2018.315&#39;</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_XYZ</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_XYZ</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_XYZ</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="PCE-Data-and-the-Orbit-File:">
<h2>PCE Data and the Orbit File:<a class="headerlink" href="#PCE-Data-and-the-Orbit-File:" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Residual-Component-Trajectory:">
<h3>Residual Component Trajectory:<a class="headerlink" href="#Residual-Component-Trajectory:" title="Permalink to this headline">¶</a></h3>
<p>Convert the Interial XYZ coordinates to the satellite coordinate system (RSW), then plot the radial component.</p>
<p><strong>Starting Systems:</strong> - <code class="docutils literal notranslate"><span class="pre">PCE</span> <span class="pre">data</span></code> - J2000 Coordinate System - Inertial satellite State Vector: <span class="math notranslate nohighlight">\([x, y, z, \dot{x}, \dot{y}, \dot{z}]\)</span> (m) - <code class="docutils literal notranslate"><span class="pre">ORBFIL</span> <span class="pre">data</span></code> - Mean of year Coordinate System - Inertial satellite State Vector: <span class="math notranslate nohighlight">\([x, y, z, \dot{x}, \dot{y}, \dot{z}]\)</span> (m)</p>
<p><strong>Convert from ``XYZ`` to ``RSW``</strong></p>
<p>From Vallado pg. 164:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">from</span> <span class="nn">PYGEODYNAnalysis_icesat2PCEtrajectory</span> <span class="kn">import</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_RSW_radial</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">subplot_titles</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;Radial Component&#39;</span><span class="p">,</span> <span class="s1">&#39;Residual (PCE-ORBFIL)&#39;</span><span class="p">]),</span>
            <span class="n">vertical_spacing</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
            <span class="n">specs</span><span class="o">=</span><span class="p">[</span> <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">False</span> <span class="p">}],</span>
                    <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">False</span> <span class="p">}]],)</span>

<span class="n">arc1</span> <span class="o">=</span> <span class="s1">&#39;2018.314&#39;</span>
<span class="n">arc2</span> <span class="o">=</span> <span class="s1">&#39;2018.315&#39;</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_RSW_radial</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_RSW_radial</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_RSW_radial</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">from</span> <span class="nn">PYGEODYNAnalysis_icesat2PCEtrajectory</span> <span class="kn">import</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_NTW_intrack</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">subplot_titles</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;In-Track Component&#39;</span><span class="p">,</span> <span class="s1">&#39;Residual (PCE-ORBFIL)&#39;</span><span class="p">]),</span>
            <span class="n">vertical_spacing</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
            <span class="n">specs</span><span class="o">=</span><span class="p">[</span> <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">False</span> <span class="p">}],</span>
                    <span class="p">[{</span><span class="s2">&quot;secondary_y&quot;</span><span class="p">:</span> <span class="kc">False</span> <span class="p">}]],)</span>

<span class="n">arc1</span> <span class="o">=</span> <span class="s1">&#39;2018.314&#39;</span>
<span class="n">arc2</span> <span class="o">=</span> <span class="s1">&#39;2018.315&#39;</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_NTW_intrack</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_NTW_intrack</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ARCOVERLAP_2arcs_ObsResids_NTW_intrack</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">Obj_Geodyn1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">arc1</span><span class="p">,</span> <span class="n">arc2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

</pre></div>
</div>
</div>
<!-- ### Check how well the PCE file and the ORBIT file match up --></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="ICESat2_TrajectoryAnalysis_MSISModels.html" class="btn btn-neutral float-right" title="A Trajectory Analysis using the ICESat2 Satellite" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../e_density_model_evaluation/pygeodyn_compare_msisversions_allarcs.html" class="btn btn-neutral float-left" title="MSIS Version Evaluation- Multiple Arcs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Zach Waldron.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>